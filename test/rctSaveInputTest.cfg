process TEST = 
{
	untracked PSet maxEvents = {untracked int32 input = 64}
#	untracked PSet maxEvents = {untracked int32 input = 2}

include "Configuration/StandardSequences/data/Services.cff"
    include "Configuration/StandardSequences/data/FakeConditions.cff"
    untracked PSet options = {
        include "FWCore/Framework/test/cmsExceptionsFatalOption.cff"
        untracked bool makeTriggerResults = true
    }

  source = FlatRandomPtGunSource
  {
	string psethack = "single e pt 35"
	untracked uint32 firstRun = 1
	untracked PSet PGunParameters = 
	{
		# You can request more than one particle
		# since PartID is a vector, you can place in as many
		# PDG id's as you wish, comma-separated
		#
		untracked vint32 PartID = {11,-11}
		untracked double MinEta = -2.5
		untracked double MaxEta = 2.5
		untracked double MinPhi = -3.14159265358979323846 # in radians
		untracked double MaxPhi = 3.14159265358979323846
		untracked double MinPt = 34.999
		untracked double MaxPt = 35.001
	}
	untracked int32 Verbosity = 0 # set to 1 (or greater) for printouts
  }

include "FWCore/MessageService/data/MessageLogger.cfi"

include "SimCalorimetry/HcalTrigPrimProducers/data/hcaltpdigi.cff"

#include "L1TriggerConfig/RCTConfigProducers/data/L1RCTConfig.cff"

include "Configuration/StandardSequences/data/Reconstruction.cff"
include "Configuration/StandardSequences/data/Simulation.cff"
include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
include "Configuration/StandardSequences/data/VtxSmearedGauss.cff" 

include "L1Trigger/RegionalCaloTrigger/data/L1RCTTestAnalyzer.cfi"
replace L1RCTTestAnalyzer.showRegionSums = false

include "Configuration/StandardSequences/data/L1Emulator.cff"
include "L1TriggerConfig/L1ScalesProducers/data/L1CaloScalesConfig.cff"

    module rctSave = L1RCTSaveInput
    {
	untracked string rctTestInputFile = "rctSaveTest.txt"
	#untracked string rctTestInputFile = "rctSaveTest_TPG_RCT_internal.txt"
	bool useEcal = true
	bool useHcal = true
	InputTag ecalDigisLabel = ecalTriggerPrimitiveDigis
	InputTag hcalDigisLabel = hcalTriggerPrimitiveDigis
    }

# ecal tpg params
# this es module already included
/*
    es_module = EcalTrigPrimESProducer {
      untracked string DatabaseFile = "TPG.txt"
    }
*/

# use identity LUT generated by modifying
# CalibCalorimetry/EcalTPGTools/test/produceTPGParameters.cfg
#replace EcalTrigPrimESProducer.DatabaseFile = "TPG_RCT_internal.txt"

# Sources of records
# first two modules already included
/*
    es_source tpparams6 = EmptyESSource {
      string recordName = "EcalTPGLutGroupRcd"
      vuint32 firstValid = { 1 }
      bool iovIsRunNotTime = true
    }
    es_source tpparams7 = EmptyESSource {
      string recordName = "EcalTPGLutIdMapRcd"
      vuint32 firstValid = { 1 }
      bool iovIsRunNotTime = true
    }
*/

# this module not already included!
# now it is
#    es_source tpparams12 = EmptyESSource {
#      string recordName = "EcalTPGPhysicsConstRcd"
#      vuint32 firstValid = { 1 }
#      bool iovIsRunNotTime = true
#    }

    path p1 = {psim} # simulation
    path p2 = {pdigi} # digitization
#    path p3 = {reconstruction_plusRS_plus_GSF} # reconstruction
#    path p4 = {L1Emulator, rctSave}
#    path p4 = {rctDigis, rctSave}
    path p4 = {rctSave}
#    path p4 = {rctDigis, L1RCTTestAnalyzer}
#    path p4 = {L1Emulator}

   # Event output
#include "Configuration/EventContent/data/EventContent.cff"
#   module FEVT = PoolOutputModule 
#   { 
#     	using FEVTSIMEventContent
#	untracked string fileName = "rctInputTest.root"
#    	untracked PSet dataset ={	
#        	untracked string dataTier = "GEN-SIM-DIGI-RECO"
#    		}
#   }

#   endpath outpath = {FEVT}


#   schedule = {input,p4,outpath}
#    schedule = {p1, p2, p3, p4}
    schedule = {p1, p2, p4}

}
